# Format Menu Split - Visual Guide

This document shows the new 3-level navigation structure for the "Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¿ÑƒĞ±Ğ»Ñ–ĞºĞ°Ñ†Ñ–Ğ¹" menu.

## Menu Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 1: Main Format Menu                 â”‚
â”‚  (callback: channel_format or format_menu) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‹ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¿ÑƒĞ±Ğ»Ñ–ĞºĞ°Ñ†Ñ–Ğ¹                       â”‚
â”‚                                             â”‚
â”‚  ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ¹Ñ‚Ğµ ÑĞº Ğ±Ğ¾Ñ‚ Ğ¿ÑƒĞ±Ğ»Ñ–ĞºÑƒĞ²Ğ°Ñ‚Ğ¸Ğ¼Ğµ           â”‚
â”‚  Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ½Ñ Ñƒ Ğ²Ğ°Ñˆ ĞºĞ°Ğ½Ğ°Ğ»:                 â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“Š Ğ“Ñ€Ğ°Ñ„Ñ–Ğº Ğ²Ñ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½ÑŒ               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  âš¡ Ğ¤Ğ°ĞºÑ‚Ğ¸Ñ‡Ğ½Ğ¸Ğ¹ ÑÑ‚Ğ°Ğ½                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  [â† ĞĞ°Ğ·Ğ°Ğ´]              [â¤´ ĞœĞµĞ½Ñ]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â”‚ (click ğŸ“Š)         â”‚
         â†“                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 2a: Schedule Format Settings        â”‚
â”‚  (callback: format_schedule_settings)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š Ğ“Ñ€Ğ°Ñ„Ñ–Ğº Ğ²Ñ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½ÑŒ                       â”‚
â”‚                                             â”‚
â”‚  ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ¹Ñ‚Ğµ ÑĞº Ğ²Ğ¸Ğ³Ğ»ÑĞ´Ğ°Ñ‚Ğ¸Ğ¼Ğµ Ğ¿Ğ¾ÑÑ‚ Ğ· Ğ³Ñ€Ğ°Ñ„Ñ–ĞºĞ¾Ğ¼ â”‚
â”‚  Ñƒ Ğ²Ğ°ÑˆĞ¾Ğ¼Ñƒ ĞºĞ°Ğ½Ğ°Ğ»Ñ–:                          â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“ ĞŸÑ–Ğ´Ğ¿Ğ¸Ñ Ğ¿Ñ–Ğ´ Ğ³Ñ€Ğ°Ñ„Ñ–ĞºĞ¾Ğ¼              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â° Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ñ‡Ğ°ÑÑƒ (08:00-12:00)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â—‹ Ğ’Ğ¸Ğ´Ğ°Ğ»ÑÑ‚Ğ¸ ÑÑ‚Ğ°Ñ€Ğ¸Ğ¹ Ğ³Ñ€Ğ°Ñ„Ñ–Ğº            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â—‹ Ğ‘ĞµĞ· Ñ‚ĞµĞºÑÑ‚Ñƒ (Ñ‚Ñ–Ğ»ÑŒĞºĞ¸ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºĞ°)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  [â† ĞĞ°Ğ·Ğ°Ğ´]              [â¤´ ĞœĞµĞ½Ñ]          â”‚
â”‚  (to Level 1)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         
         (from Level 1, click âš¡)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 2b: Power State Settings            â”‚
â”‚  (callback: format_power_settings)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš¡ Ğ¤Ğ°ĞºÑ‚Ğ¸Ñ‡Ğ½Ğ¸Ğ¹ ÑÑ‚Ğ°Ğ½                          â”‚
â”‚                                             â”‚
â”‚  ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ½Ñ ÑĞºÑ– Ğ±Ğ¾Ñ‚ Ğ½Ğ°Ğ´ÑĞ¸Ğ»Ğ°Ñ”  â”‚
â”‚  Ğ¿Ñ€Ğ¸ Ğ·Ğ¼Ñ–Ğ½Ñ– ÑÑ‚Ğ°Ğ½Ñƒ ÑĞ²Ñ–Ñ‚Ğ»Ğ°:                   â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ”´ ĞŸĞ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ½Ñ "Ğ¡Ğ²Ñ–Ñ‚Ğ»Ğ¾ Ğ·Ğ½Ğ¸ĞºĞ»Ğ¾"     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸŸ¢ ĞŸĞ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ½Ñ "Ğ¡Ğ²Ñ–Ñ‚Ğ»Ğ¾ Ñ”"          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  [â† ĞĞ°Ğ·Ğ°Ğ´]              [â¤´ ĞœĞµĞ½Ñ]          â”‚
â”‚  (to Level 1)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Changes

### Before (Old Flat Menu)
- Single menu with 8 buttons
- Non-clickable header buttons ("â”€â”€ ğŸ“Š Ğ“Ğ ĞĞ¤Ğ†Ğš Ğ’Ğ†Ğ”ĞšĞ›Ğ®Ğ§Ğ•ĞĞ¬ â”€â”€", "â”€â”€ âš¡ Ğ¤ĞĞšĞ¢Ğ˜Ğ§ĞĞ˜Ğ™ Ğ¡Ğ¢ĞĞ â”€â”€")
- `format_noop` callback for headers (confusing for users)
- All settings mixed together
- Back button goes to `settings_channel`

### After (New 3-Level Structure)
- **Level 1**: 2 main category buttons (Schedule, Power State)
- **Level 2a**: 4 schedule-related settings
- **Level 2b**: 2 power-state settings
- All buttons are clickable and functional
- Clear navigation flow
- Back buttons from Level 2 go to `format_menu` (Level 1)

## Button Mappings

### Level 1 â†’ Level 2a (Schedule Settings)
```
ğŸ“Š Ğ“Ñ€Ğ°Ñ„Ñ–Ğº Ğ²Ñ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½ÑŒ â†’ format_schedule_settings
```

### Level 1 â†’ Level 2b (Power State Settings)
```
âš¡ Ğ¤Ğ°ĞºÑ‚Ğ¸Ñ‡Ğ½Ğ¸Ğ¹ ÑÑ‚Ğ°Ğ½ â†’ format_power_settings
```

### Level 2 â†’ Level 1 (Back Navigation)
```
â† ĞĞ°Ğ·Ğ°Ğ´ â†’ format_menu
```

## Toggle Behavior

The toggle buttons in Level 2a work as before:
- Click toggles the setting on/off
- Page refreshes with updated toggle state (â—‹ or âœ“)
- Now stays in Level 2a (schedule settings) instead of going back to flat menu

## Text Editing Return Navigation

When editing text templates:
- **Schedule caption** â†’ Returns to Level 2a (schedule settings)
- **Period format** â†’ Returns to Level 2a (schedule settings)
- **Power off text** â†’ Returns to Level 2b (power state settings)
- **Power on text** â†’ Returns to Level 2b (power state settings)

## Implementation Details

### Files Modified
1. `src/keyboards/inline.js`
   - Updated `getFormatSettingsKeyboard()` for Level 1
   - Added `getFormatScheduleKeyboard()` for Level 2a
   - Added `getFormatPowerKeyboard()` for Level 2b

2. `src/handlers/channel.js`
   - Added `FORMAT_SCHEDULE_MESSAGE` constant
   - Added `FORMAT_POWER_MESSAGE` constant
   - Updated `FORMAT_SETTINGS_MESSAGE` text
   - Added `format_menu` handler
   - Added `format_schedule_settings` handler
   - Added `format_power_settings` handler
   - Updated toggle handlers to use Level 2a keyboard
   - Updated text input handlers to return to correct sub-menu
   - Removed `format_noop` handler

### Callback Data Changes
| Old Callback | New Callback | Purpose |
|-------------|--------------|---------|
| `format_noop` | (removed) | Non-interactive headers removed |
| N/A | `format_menu` | Navigate to Level 1 |
| N/A | `format_schedule_settings` | Navigate to Level 2a |
| N/A | `format_power_settings` | Navigate to Level 2b |
| `format_toggle_delete` | (same) | Toggle delete old message |
| `format_toggle_piconly` | (same) | Toggle picture only |
| `format_schedule_caption` | (same) | Edit schedule caption |
| `format_schedule_periods` | (same) | Edit period format |
| `format_power_off` | (same) | Edit power off text |
| `format_power_on` | (same) | Edit power on text |

## User Experience Improvements

1. **Clearer structure**: Settings are grouped logically
2. **No confusion**: All buttons are clickable and do something
3. **Better navigation**: Clear back button hierarchy
4. **Easier to find settings**: Only 2 choices at top level
5. **Less overwhelming**: Fewer buttons per screen
